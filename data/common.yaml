---
lookup_options:
  # Allow system specific datafiles to extend php config sets
  isp3node::php::setup::sets:
    merge: deep

# Taken from facts if not set
#isp3node::base::ip: 127.0.0.1
#isp3node::base::hostname: isphost01
#isp3node::base::domain: mydomain.space

# For list of attributes, see https://puppet.com/docs/puppet/5.5/types/host.html
#isp3node::base::hosts::entries:
#  openwrt.fdb.fuermann.net:
#    ensure: present
#    ip: 192.168.10.1

isp3node::base::ssl::letsencrypt: true

isp3node::mariadb::setup::additional_packages:
  - dbconfig-common
  - dbconfig-mysql

isp3node::postfix::setup::master_submission: |
  submission inet n - y - - smtpd
  -o syslog_name=postfix/submission
  -o smtpd_tls_security_level=encrypt
  -o smtpd_sasl_auth_enable=yes
  -o smtpd_client_restrictions=permit_sasl_authenticated,reject

isp3node::postfix::setup::master_smtps: |
  smtps inet n - y - - smtpd
  -o syslog_name=postfix/smtps
  -o smtpd_tls_wrappermode=yes
  -o smtpd_sasl_auth_enable=yes
  -o smtpd_client_restrictions=permit_sasl_authenticated,reject

#isp3node::postfix::satellite::relay: my.relay.server.de
#isp3node::postfix::setup::mailman: false

isp3node::php::setup::version: "7.3"
isp3node::php::setup::sets:
  # minimum, required on all isp nodes
  default:
    #packages:
      # System package names depend on OS, defined in OS data files
    extensions:
      bcmath: {}
      curl: {}
      mbstring: {}
      mysql: {} 
    settings:
      PHP/max_execution_time: 90
      PHP/max_input_time: 300
      PHP/memory_limit: 64M
      PHP/post_max_size: 32M
      PHP/upload_max_filesize: 32M
      PHP/cgi.fix_pathinfo: 0
      Date/date.timezone: Europe/Berlin
  master:
    extensions:
      apcu:
        #        provider: pecl
        settings:
            apc/stat: 1
            apc/stat_ctime: 1
        sapi: fpm
      curl: {}
      gd: {}
      gettext: {}
      imagick: {}
      imap: {}
      intl: {}
      memcached: {}
      pdo: {}
      pspell: {}
      opcache: {}
      recode: {}
      soap: {}
      tidy: {}
      xmlrpc: {}
      xsl: {}
      zip: {}
  web:
    extensions:
      apcu:
        #        provider: pecl
        settings:
            apc/stat: 1
            apc/stat_ctime: 1
        sapi: fpm
      cgi: {}
      curl: {}
      gd: {}
      gettext: {}
      imagick: {}
      imap: {}
      intl: {}
      memcached: {}
      pdo: {}
      pspell: {}
      opcache: {}
      recode: {}
      soap: {}
      sqlite3: {}
      tidy: {}
      xmlrpc: {}
      xsl: {}
      zip: {}
    features:
      - fpm
      - composer
      - pear
      - phpunit

# Set up a web frontend or just list the server on other frontends
isp3node::phpmyadmin::frontend: false
isp3node::phpmyadmin::setup::source: 
  url: https://files.phpmyadmin.net/phpMyAdmin/5.0.1/phpMyAdmin-5.0.1-all-languages.tar.gz
  checksum: 1bd82fdcf5375526c8b5124a20968b69981724307d878321ae29499c61bbf48e
  checksum_type: sha256
# Set your own !
# isp3node::phpmyadmin::setup::blowfish_secret: ispconfig-pma-bfs
isp3node::phpmyadmin::setup::controluser: ispconfig-pma
# Set your own !
# isp3node::phpmyadmin::setup::controlpass: ispconfig-pma-pass
# Create the hash by executing in a sql shell:
# SELECT PASSWORD('my-password');
# ispconfig3::phpmyadmin::controlpass_hash: '*B2BA8208A112BD88AFB6F58055F70725D4238156'
